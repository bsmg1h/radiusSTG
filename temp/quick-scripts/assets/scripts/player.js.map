{"version":3,"sources":["player.js"],"names":["cc","Class","extends","Component","properties","spaceMoving","Damping","accel","maxMoveSpeed","setInputControl","self","eventManager","addListener","event","EventListener","KEYBOARD","onKeyPressed","keyCode","KEY","a","accLeft","accRight","moveLeft","moveRight","d","w","accUp","accDown","moveUp","moveDown","s","onKeyReleased","node","onLoad","xSpeed","ySpeed","update","dt","Math","abs","x","y","parent","width","height"],"mappings":"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","file":"player.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n        spaceMoving: false,\n        Damping: 0.01,\n        accel: 0,\n        maxMoveSpeed: 0\n    },\n\n    setInputControl: function(){\n        var self = this;\n        //添加键盘事件侦听\n        cc.eventManager.addListener({\n            event: cc.EventListener.KEYBOARD,\n            //有按键按下时，判断是否有我们制定的方向控制键，并设置相对应方向加速\n            onKeyPressed: function (keyCode, event) {\n                switch(keyCode) {\n                    case cc.KEY.a:\n                        self.accLeft = true;\n                        self.accRight = false;\n                        self.moveLeft = true;\n                        self.moveRight = false;\n                        break;\n                    case cc.KEY.d:\n                        self.accLeft = false;\n                        self.accRight = true;\n                        self.moveLeft = false;\n                        self.moveRight = true;\n                        break;\n                    case cc.KEY.w:\n                        self.accUp = true;\n                        self.accDown = false;\n                        self.moveUp = true;\n                        self.moveDown = false;\n                        break;\n                    case cc.KEY.s:\n                        self.accUp = false;\n                        self.accDown = true;\n                        self.moveUp = false;\n                        self.moveDown = true;\n                }\n            },\n            onKeyReleased: function(keyCode, event){\n                switch(keyCode){\n                    case cc.KEY.a:\n                        self.accLeft = false;\n                        self.moveLeft = false;\n                        break;\n                    case cc.KEY.d:\n                        self.accRight = false;\n                        self.moveRight = false;\n                        break;\n                    case cc.KEY.w:\n                        self.accUp = false;\n                        self.moveUp = false;\n                        break;\n                    case cc.KEY.s:\n                        self.accDown = false;\n                        self.moveDown = false;\n                        break;\n                }\n            }\n        }, self.node);\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.accLeft = false;\n        this.accRight = false;\n        this.accUp = false;\n        this.accDown = false;\n\n        this.moveLeft = false;\n        this.moveRight = false;\n        this.moveUp = false;\n        this.moveDown = false;\n\n        this.xSpeed = 0;\n        this.ySpeed = 0;\n\n        this.setInputControl();\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        if (!this.spaceMoving){\n            if (this.moveLeft) {\n                this.xSpeed = -1 * this.maxMoveSpeed;\n            } else if (this.moveRight) {\n                this.xSpeed  = this.maxMoveSpeed;\n            } else {\n                this.xSpeed = 0;\n            }\n            if (this.moveUp) {\n                this.ySpeed = this.maxMoveSpeed;\n            } else if (this.moveDown) {\n                this.ySpeed  = -1 * this.maxMoveSpeed;\n            } else {\n                this.ySpeed = 0;\n            }\n        } else if (this.spaceMoving){\n            if (this.accLeft) {\n                this.xSpeed -= this.accel * dt;\n            } else if (this.accRight) {\n                this.xSpeed += this.accel * dt;\n            }\n            if (this.accUp) {\n                this.ySpeed += this.accel * dt;\n            } else if (this.accDown) {\n                this.ySpeed -= this.accel * dt;\n            }\n            this.xSpeed *= (1-this.Damping);\n            this.ySpeed *= (1-this.Damping);\n        }\n        \n        if (Math.abs(this.xSpeed) > this.maxMoveSpeed){\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\n        }\n\n        if (Math.abs(this.ySpeed) > this.maxMoveSpeed){\n            this.ySpeed = this.maxMoveSpeed * this.ySpeed / Math.abs(this.ySpeed);\n        }\n\n        this.node.x += this.xSpeed * dt;\n        this.node.y += this.ySpeed * dt;\n\n        if (!this.spaceMoving) {\n            if (this.node.x > this.node.parent.width/2 - this.node.width/2) {\n                this.node.x = this.node.parent.width/2 - this.node.width/2;\n                this.xSpeed = 0;\n            } else if ( this.node.x < -this.node.parent.width/2 + this.node.width/2) {\n                this.node.x = -this.node.parent.width/2 + this.node.width/2;\n                this.xSpeed = 0;\n            }\n            if (this.node.y > this.node.parent.height/2 - this.node.height/2) {\n                this.node.y = this.node.parent.height/2 - this.node.height/2;\n                this.ySpeed = 0;\n            } else if ( this.node.y < -this.node.parent.height/2 + this.node.height/2) {\n                this.node.y = -this.node.parent.height/2 + this.node.height/2;\n                this.ySpeed = 0;\n            }\n        } else if (this.spaceMoving){\n            if (this.node.x > this.node.parent.width/2 - this.node.width/2) {\n                this.node.x = this.node.parent.width/2 - this.node.width/2;\n                this.xSpeed *= -1;\n            } else if ( this.node.x < -this.node.parent.width/2 + this.node.width/2) {\n                this.node.x = -this.node.parent.width/2 + this.node.width/2;\n                this.xSpeed *= -1;\n            }\n            if (this.node.y > this.node.parent.height/2 - this.node.height/2) {\n                this.node.y = this.node.parent.height/2 - this.node.height/2;\n                this.ySpeed *= -1;\n            } else if ( this.node.y < -this.node.parent.height/2 + this.node.height/2) {\n                this.node.y = -this.node.parent.height/2 + this.node.height/2;\n                this.ySpeed *= -1;\n            }\n        }\n    }\n});\n"]}