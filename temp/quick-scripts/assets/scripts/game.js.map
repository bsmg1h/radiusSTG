{"version":3,"sources":["game.js"],"names":["cc","Class","extends","Component","properties","bulletPrefab","default","type","Prefab","enemyPrefab","bulletInterval","bulletSpeedCoefficient","bulletSpeedIntercept","w","spawnEnemy","log","positionX","randomMinus1To1","node","width","positionY","height","newEnemy","instantiate","addChild","setPosition","p","getComponent","init","test","onLoad","T","deltaT","i","newBullets","director","getCollisionManager","enabled","enabledDebugDraw","update","dt","shootNewBullet","speed","theta","Math","PI"],"mappings":"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","file":"game.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n        //加载子弹的Prefab素材\n        bulletPrefab:{\n            default: null,\n            type: cc.Prefab\n        },\n        enemyPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        //两颗子弹的发射间隔\n        bulletInterval: 500,\n        //子弹速度斜率\n        bulletSpeedCoefficient: 500,\n        //子弹速度截距\n        bulletSpeedIntercept: 100,\n        //子弹发射角速度\n        w : 0.1\n    },\n\n    //test\n    spawnEnemy: function () {\n        cc.log(\"spawn new Enemy\");\n        var positionX = cc.randomMinus1To1() * this.node.width / 2;\n        var positionY = cc.randomMinus1To1() * this.node.height / 2;\n        var newEnemy = cc.instantiate(this.enemyPrefab);\n        this.node.addChild(newEnemy);\n        newEnemy.setPosition(cc.p(positionX, positionY));\n        // pass Game instance to star\n        newEnemy.getComponent('enemy').init(this);\n    },\n    test: function() {\n        this.node.width = 3;\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        //总计时器\n        this.T = 0\n        //子弹间隔计时器\n        this.deltaT = 0;\n        //计数器\n        this.i = -1;\n        //存储子弹数组\n        this.newBullets = [];\n        //Generate Enemies\n        this.spawnEnemy();\n        // Collision System\n        cc.director.getCollisionManager().enabled = true;\n        cc.director.getCollisionManager().enabledDebugDraw = true;\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        this.deltaT += dt;\n        this.T += dt;\n        if (this.deltaT > this.bulletInterval){\n            //如果计时器大于子弹发射时间间隔，则发射子弹\n            //计时器归零\n            this.shootNewBullet(this.T - this.T % this.bulletInterval, 5);\n            this.deltaT -= this.bulletInterval;\n        }\n    },\n\n    shootNewBullet: function (T, w) {\n        for(var i = 0; i < w; ++i)\n        {\n            this.newBullets[i] = cc.instantiate(this.bulletPrefab);\n            this.newBullets[i].getComponent(\"bullet\").speed = 250;\n            this.newBullets[i].getComponent(\"bullet\").theta = this.T * this.T * Math.PI / 8 + 2 * Math.PI * i / w;\n            this.newBullets[i].setPosition(cc.p(0,0));\n            this.node.addChild(this.newBullets[i]);\n        }\n    }\n});\n"]}