{"version":3,"sources":["../../../../assets/scripts/assets/scripts/player.js"],"names":["cc","Class","extends","Component","properties","spaceMoving","Damping","accel","maxMoveSpeed","setInputControl","self","eventManager","addListener","event","EventListener","KEYBOARD","onKeyPressed","keyCode","KEY","a","left","accLeft","accRight","moveLeft","moveRight","d","right","w","up","accUp","accDown","moveUp","moveDown","s","down","shift","slowMode","onKeyReleased","node","onLoad","xSpeed","ySpeed","onCollisionEnter","other","log","tag","setPositionX","setPositionY","update","dt","speedFactor","Math","abs","x","y","parent","width","height"],"mappings":"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","file":"player.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n        spaceMoving: false,\n        Damping: 0.01,\n        accel: 0,\n        maxMoveSpeed: 0,\n    },\n\n    setInputControl: function(){\n        var self = this;\n        //添加键盘事件侦听\n        cc.eventManager.addListener({\n            event: cc.EventListener.KEYBOARD,\n            //有按键按下时，判断是否有我们制定的方向控制键，并设置相对应方向加速\n            onKeyPressed: function (keyCode, event) {\n                switch(keyCode) {\n                    case cc.KEY.a:\n                    case cc.KEY.left:\n                        self.accLeft = true;\n                        self.accRight = false;\n                        self.moveLeft = true;\n                        self.moveRight = false;\n                        break;\n                    case cc.KEY.d:\n                    case cc.KEY.right:\n                        self.accLeft = false;\n                        self.accRight = true;\n                        self.moveLeft = false;\n                        self.moveRight = true;\n                        break;\n                    case cc.KEY.w:\n                    case cc.KEY.up:\n                        self.accUp = true;\n                        self.accDown = false;\n                        self.moveUp = true;\n                        self.moveDown = false;\n                        break;\n                    case cc.KEY.s:\n                    case cc.KEY.down:\n                        self.accUp = false;\n                        self.accDown = true;\n                        self.moveUp = false;\n                        self.moveDown = true;\n                        break;\n                    case cc.KEY.shift:\n                        self.slowMode = true;\n                        break;\n                }\n            },\n            onKeyReleased: function(keyCode, event){\n                switch(keyCode){\n                    case cc.KEY.a:\n                    case cc.KEY.left:\n                        self.accLeft = false;\n                        self.moveLeft = false;\n                        break;\n                    case cc.KEY.d:\n                    case cc.KEY.right:\n                        self.accRight = false;\n                        self.moveRight = false;\n                        break;\n                    case cc.KEY.w:\n                    case cc.KEY.up:\n                        self.accUp = false;\n                        self.moveUp = false;\n                        break;\n                    case cc.KEY.s:\n                    case cc.KEY.down:\n                        self.accDown = false;\n                        self.moveDown = false;\n                        break;\n                    case cc.KEY.shift:\n                        self.slowMode = false;\n                        break;\n                }\n            }\n        }, self.node);\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.accLeft = false;\n        this.accRight = false;\n        this.accUp = false;\n        this.accDown = false;\n\n        this.moveLeft = false;\n        this.moveRight = false;\n        this.moveUp = false;\n        this.moveDown = false;\n\n        this.slowMode = false;\n\n        this.xSpeed = 0;\n        this.ySpeed = 0;\n\n        this.setInputControl();\n    },\n\n    onCollisionEnter: function (other, self) {\n        cc.log(\"Player is hit by bullet: \" + (other.tag == 1));\n        this.node.setPositionX(0);\n        this.node.setPositionY(-200);\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        if (!this.spaceMoving){\n            var speedFactor = (this.slowMode ? 0.25 : 1);\n            if (this.moveLeft) {\n                this.xSpeed = -1 * speedFactor * this.maxMoveSpeed;\n            } else if (this.moveRight) {\n                this.xSpeed  = speedFactor * this.maxMoveSpeed;\n            } else {\n                this.xSpeed = 0;\n            }\n            if (this.moveUp) {\n                this.ySpeed = speedFactor * this.maxMoveSpeed;\n            } else if (this.moveDown) {\n                this.ySpeed  = -1 * speedFactor * this.maxMoveSpeed;\n            } else {\n                this.ySpeed = 0;\n            }\n        } else if (this.spaceMoving){\n            if (this.accLeft) {\n                this.xSpeed -= this.accel * dt;\n            } else if (this.accRight) {\n                this.xSpeed += this.accel * dt;\n            }\n            if (this.accUp) {\n                this.ySpeed += this.accel * dt;\n            } else if (this.accDown) {\n                this.ySpeed -= this.accel * dt;\n            }\n            this.xSpeed *= (1-this.Damping);\n            this.ySpeed *= (1-this.Damping);\n        }\n        \n        if (Math.abs(this.xSpeed) > this.maxMoveSpeed){\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\n        }\n\n        if (Math.abs(this.ySpeed) > this.maxMoveSpeed){\n            this.ySpeed = this.maxMoveSpeed * this.ySpeed / Math.abs(this.ySpeed);\n        }\n\n        this.node.x += this.xSpeed * dt;\n        this.node.y += this.ySpeed * dt;\n\n        if (!this.spaceMoving) {\n            if (this.node.x > this.node.parent.width/2 - this.node.width/2) {\n                this.node.x = this.node.parent.width/2 - this.node.width/2;\n                this.xSpeed = 0;\n            } else if ( this.node.x < -this.node.parent.width/2 + this.node.width/2) {\n                this.node.x = -this.node.parent.width/2 + this.node.width/2;\n                this.xSpeed = 0;\n            }\n            if (this.node.y > this.node.parent.height/2 - this.node.height/2) {\n                this.node.y = this.node.parent.height/2 - this.node.height/2;\n                this.ySpeed = 0;\n            } else if ( this.node.y < -this.node.parent.height/2 + this.node.height/2) {\n                this.node.y = -this.node.parent.height/2 + this.node.height/2;\n                this.ySpeed = 0;\n            }\n        } else if (this.spaceMoving){\n            if (this.node.x > this.node.parent.width/2 - this.node.width/2) {\n                this.node.x = this.node.parent.width/2 - this.node.width/2;\n                this.xSpeed *= -1;\n            } else if ( this.node.x < -this.node.parent.width/2 + this.node.width/2) {\n                this.node.x = -this.node.parent.width/2 + this.node.width/2;\n                this.xSpeed *= -1;\n            }\n            if (this.node.y > this.node.parent.height/2 - this.node.height/2) {\n                this.node.y = this.node.parent.height/2 - this.node.height/2;\n                this.ySpeed *= -1;\n            } else if ( this.node.y < -this.node.parent.height/2 + this.node.height/2) {\n                this.node.y = -this.node.parent.height/2 + this.node.height/2;\n                this.ySpeed *= -1;\n            }\n        }\n    }\n});\n"]}